{"timestamp":"2025-09-09T13:09:15.566384","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-09T13:09:15.566830","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/finances/daily_get_tickers.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-09T13:09:15.650038Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:15.650220Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:15.650424Z","level":"info","event":"Current task name:get_tickers","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:15.650526Z","level":"info","event":"Dag name:daily_get_tickers","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:15.673747","level":"info","event":"Starting docker container from image finances:latest","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:15.676083","level":"warning","event":"Using remote engine or docker-in-docker and mounting temporary volume from host is not supported. Falling back to `mount_tmp_dir=False` mode. You can set `mount_tmp_dir` parameter to False to disable mounting and remove the warning","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735009","level":"info","event":"Traceback (most recent call last):","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735247","level":"info","event":"  File \"/usr/local/lib/python3.12/site-packages/pandas/compat/_optional.py\", line 135, in import_optional_dependency","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735377","level":"info","event":"    module = importlib.import_module(name)","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735488","level":"info","event":"             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735595","level":"info","event":"  File \"/usr/local/lib/python3.12/importlib/__init__.py\", line 90, in import_module","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735763","level":"info","event":"    return _bootstrap._gcd_import(name[level:], package, level)","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735871","level":"info","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.735954","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736035","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736118","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1310, in _find_and_load_unlocked","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736239","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736350","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736439","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736522","level":"info","event":"  File \"<frozen importlib._bootstrap>\", line 1324, in _find_and_load_unlocked","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736603","level":"info","event":"ModuleNotFoundError: No module named 'lxml'","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736682","level":"info","event":"","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736760","level":"info","event":"During handling of the above exception, another exception occurred:","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736835","level":"info","event":"","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736912","level":"info","event":"Traceback (most recent call last):","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.736999","level":"info","event":"  File \"/app/lib/get_tickers.py\", line 32, in <module>","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737135","level":"info","event":"    send_to_kafka()","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737243","level":"info","event":"  File \"/app/lib/get_tickers.py\", line 26, in send_to_kafka","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737340","level":"info","event":"    value=sp500_tickers()","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737420","level":"info","event":"          ^^^^^^^^^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737497","level":"info","event":"  File \"/app/lib/get_tickers.py\", line 13, in sp500_tickers","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737617","level":"info","event":"    df = pd.read_html(StringIO(response.text))[0]","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737700","level":"info","event":"         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737780","level":"info","event":"  File \"/usr/local/lib/python3.12/site-packages/pandas/io/html.py\", line 1240, in read_html","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.737899","level":"info","event":"    return _parse(","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738031","level":"info","event":"           ^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738150","level":"info","event":"  File \"/usr/local/lib/python3.12/site-packages/pandas/io/html.py\", line 971, in _parse","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738365","level":"info","event":"    parser = _parser_dispatch(flav)","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738492","level":"info","event":"             ^^^^^^^^^^^^^^^^^^^^^^","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738579","level":"info","event":"  File \"/usr/local/lib/python3.12/site-packages/pandas/io/html.py\", line 918, in _parser_dispatch","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738700","level":"info","event":"    import_optional_dependency(\"lxml.etree\")","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738799","level":"info","event":"  File \"/usr/local/lib/python3.12/site-packages/pandas/compat/_optional.py\", line 138, in import_optional_dependency","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738879","level":"info","event":"    raise ImportError(msg)","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.738958","level":"info","event":"ImportError: Missing optional dependency 'lxml'.  Use pip or conda to install lxml.","logger":"airflow.task.operators.airflow.providers.docker.operators.docker.DockerOperator"}
{"timestamp":"2025-09-09T13:09:16.951578","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"DockerContainerFailedException","exc_value":"Docker container failed: {'StatusCode': 1}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/docker/operators/docker.py","lineno":500,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/docker/operators/docker.py","lineno":374,"name":"_run_image"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/docker/operators/docker.py","lineno":435,"name":"_run_image_with_mounts"}],"is_group":false,"exceptions":[]},{"exc_type":"APIError","exc_value":"400 Client Error for http+docker://localhost/v1.47/containers/create: Bad Request (\"invalid mount config for type \"bind\": bind source path does not exist: /tmp/airflowtmpfdzmv6e0\")","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/docker/operators/docker.py","lineno":365,"name":"_run_image"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/docker/operators/docker.py","lineno":392,"name":"_run_image_with_mounts"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/api/container.py","lineno":440,"name":"create_container"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/api/container.py","lineno":457,"name":"create_container_from_config"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/api/client.py","lineno":281,"name":"_result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/api/client.py","lineno":277,"name":"_raise_for_status"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/errors.py","lineno":39,"name":"create_api_error_from_http_exception"}],"is_group":false,"exceptions":[]},{"exc_type":"HTTPError","exc_value":"400 Client Error: Bad Request for url: http+docker://localhost/v1.47/containers/create","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/docker/api/client.py","lineno":275,"name":"_raise_for_status"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/models.py","lineno":1026,"name":"raise_for_status"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-09T13:09:16.952823Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:16.953019Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:16.953073Z","level":"info","event":"Task:<Task(DockerOperator): get_tickers>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-09T13:09:16.953120Z","level":"info","event":"Failure caused by Docker container failed: {'StatusCode': 1}","chan":"stdout","logger":"task"}
